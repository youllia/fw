(()=>{"use strict";var e={127:e=>{e.exports=JSON.parse('{"Latitude":"Широта","Longitude":"Долгота","Search":"Поиск","Search City":"Поиск по городу","Feels like":"Ощущается как","Wind":"Ветер","Humidity":"Влажность","m/s":"м/с","Tomorrow":"Завтра","The next day":"Через день","In two days":"Через 2 дня","Enter the name of the City or City and Country":"Введите название Города или Города и Страны"}')}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}(()=>{const e={language:"en",units:"metric",ip:void 0,date:"",country:"",city:"",latitude:"",longitude:"",timeZone:"",region:"",postal:"",weatherState:{id:0,main:"",description:"",icon:""},weatherFeelsLike:0,temperature:"",wind:{deg:0,speed:0},humidity:"",dailyTemp:{dayFirst:"",daySecond:"",dayThird:""},dailyWeatherState:{dayFirst:"",daySecond:"",dayThird:""},dailyWeatherIcon:{dayFirst:"",daySecond:"",dayThird:""},weekDays:{dayFirst:"",daySecond:"",dayThird:""},bgLink:"",locationMapLink:""};function t(e,t){window.localStorage.setItem(e,JSON.stringify(t))}async function r(e){return fetch(e).then((e=>{if(e.ok)return e.json();throw new Error("Something went wrong")})).catch((e=>console.log(e)))}const a=new URL("json","https://ipinfo.io"),i=new URL("geocode/v1/json","https://api.opencagedata.com"),s=new URL("data/2.5/onecall","https://api.openweathermap.org"),o=new URL("photos/random","https://api.unsplash.com"),c=new URL("geocode/v1/json","https://api.opencagedata.com");function u(e,t){const n="en"===t?"en-GB":"ru-RU",r=(new Date).toLocaleString(n,{timeZone:e,weekday:"short",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}).split(","),a=r.pop();return r.join(","),r+a}function d(e,t){const n=parseFloat(t),r=parseFloat(e);return`https://www.openstreetmap.org/export/embed.html?bbox=${[r-.01,n-.01,r+.01,n+.01].join("%2C")}&amp;layer=mapnik`}function l(e){return parseFloat(e).toFixed(2).split(".").join("°").concat("'")}async function h(){const{current:n,daily:a,timezone:i}=await function(){const{language:t,units:n,latitude:a,longitude:i}=e;return s.searchParams.set("lat",a),s.searchParams.set("lon",i),s.searchParams.set("exclude","minutely,hourly"),s.searchParams.set("lang",t),s.searchParams.set("units",n),s.searchParams.set("appid","dec4882934b59d9181c431a3ffa0ba9c"),r(s).then((e=>{for(let t=0;t<3;t++)if(void 0!==e.daily[t])for(let n=0;n<e.daily[t].weather.length;n++){const{icon:r}=e.daily[t].weather[n];e.daily[t].weather[n].icon=`http://openweathermap.org/img/wn/${r}@2x.png`}return void 0!==e.current&&(e.current.weather[0].icon=`http://openweathermap.org/img/wn/${e.current.weather[0].icon}@4x.png`),e}))}(),{temp:o,humidity:c,feels_like:d,wind_speed:l,wind_deg:h,weather:m}=n;e.timeZone=i,e.date=u(e.timeZone,e.language),function(t,n){const r="en"===n?"en-GB":"ru-RU",a=new Date,i=new Date(a.getFullYear(),a.getMonth(),a.getDate()+1).toLocaleString(r,{timeZone:t,weekday:"long"}),s=new Date(a.getFullYear(),a.getMonth(),a.getDate()+2).toLocaleString(r,{timeZone:t,weekday:"long"}),o=new Date(a.getFullYear(),a.getMonth(),a.getDate()+3).toLocaleString(r,{timeZone:t,weekday:"long"});Object.assign(e.weekDays,{dayFirst:i,daySecond:s,dayThird:o})}(e.timeZone,e.language),e.humidity=c,e.temperature=Math.round(o),e.weatherFeelsLike=Math.round(d),Object.assign(e.weatherState,m[0]),Object.assign(e.wind,{speed:Math.round(l),deg:h});const[g,p,y]=a,{day:_}=g.temp,{day:w}=p.temp,{day:f}=y.temp;Object.assign(e.dailyTemp,{dayFirst:Math.round(_),daySecond:Math.round(w),dayThird:Math.round(f)});const[b]=g.weather,{icon:k,description:L}=b,[S]=p.weather,{icon:v,description:x}=S,[C]=y.weather,{icon:F,description:$}=C;Object.assign(e.dailyWeatherState,{dayFirst:L,daySecond:x,dayThird:$}),Object.assign(e.dailyWeatherIcon,{dayFirst:k,daySecond:v,dayThird:F}),t("state",e)}async function m(){const{urls:t}=await async function(){const{description:t}=e.weatherState,n=e.country,{city:a}=e,i=(new Date).toLocaleString("en-GB",{month:"long"}),s=["nature","landscape",`${encodeURIComponent(i)}`,`${encodeURIComponent(a)}`,`${encodeURIComponent(t)}`].join("+");return o.searchParams.set("orientation","landscape"),o.searchParams.set("per_page","1"),o.searchParams.set("query",s),o.searchParams.set("location",n),o.searchParams.set("client_id","GEV6EB4gd42URLtZCBcbsDCLOP2LYHbr28VLzzQmATE"),r(o)}(),{regular:n}=t;e.bgLink=n}async function g(){const n=await function(){const{latitude:t,longitude:n,language:a}=e;return c.searchParams.set("q",`${t}, ${n}`),c.searchParams.set("language",a),c.searchParams.set("pretty","1"),c.searchParams.set("key","81015d7e7219436abb15a79cd774330f"),r(c).then((e=>{const{results:t}=e||{},[n]=t||[];return n}))}();if(void 0===n)return;const{components:a}=n,{country:i,state:s,city:o,town:u,village:d,neighbourhood:l,suburb:h,place:m,highway:g}=a;e.city=o||u||d||m||l||h||g||s||"",e.country=i||"",t("state",e)}class p{constructor(e,...t){this.element=document.createElement(e),t.length>0&&this.element.classList.add(...t)}content(...e){return e.forEach((e=>{e instanceof p?this.element.appendChild(e.element):this.element.innerHTML+=String(e)})),this}id(e){return this.element.setAttribute("id",e),this}data(e,t){return this.element.setAttribute(`data-${e}`,t),this}onClick(e){return this.element.addEventListener("click",e),this}toggleClass(e){this.element.classList.contains(e)?this.element.classList.toggle(e,!1):this.element.classList.toggle(e,!0)}onLoad(e){return this.element.addEventListener("load",e),this}}class y extends p{constructor(...e){super("main",...e)}}class _ extends p{constructor(...e){super("div",...e)}}function w(...e){return new _(...e)}class f extends p{constructor(...e){super("header",...e)}}function b(...e){return new f(...e)}class k extends p{constructor(...e){super("h1",...e)}}class L extends p{constructor(...e){super("p",...e)}}function S(...e){return new L(...e)}class v extends p{constructor(...e){super("section",...e)}}function x(...e){return new v(...e)}class C extends p{constructor(...e){super("img",...e)}alt(e){return this.element.setAttribute("alt",e),this}width(e){return this.element.setAttribute("width",e),this}height(e){return this.element.setAttribute("height",e),this}src(e){return this.element.setAttribute("src",e),this}}function F(...e){return new C(...e)}class $ extends p{constructor(...e){super("h2",...e)}}class A extends p{constructor(...e){super("ul",...e)}onChange(e){return this.element.addEventListener("change",e),this}}class P extends p{constructor(...e){super("li",...e)}}function T(...e){return new P(...e)}class j extends p{constructor(...e){super("span",...e)}}class D extends p{constructor(...e){super("i",...e)}}function E(...e){return new D(...e)}class M extends p{constructor(...e){super("h3",...e)}}function Z(...e){return new M(...e)}class R extends p{constructor(...e){super("figure",...e)}}class I extends p{constructor(...e){super("iframe",...e)}title(e){return this.element.setAttribute("title",e),this}width(e){return this.element.setAttribute("width",e),this}height(e){return this.element.setAttribute("height",e),this}src(e){return this.element.setAttribute("src",e),this}}const O=n(127);function U(t){const{language:n}=e;return"ru"===n&&O[t]||t}class q extends p{constructor(...e){super("form",...e)}onSubmit(e){return this.element.addEventListener("submit",e),this}}function W(...e){return new q(...e)}class z extends p{constructor(...e){super("button",...e)}name(e){return this.element.setAttribute("name",e),this}type(e){return this.element.setAttribute("type",e),this}value(e){return this.element.setAttribute("value",e),this}role(e){return this.element.setAttribute("value",e),this}ariaChecked(e){return this.element.setAttribute("aria-checked",e.toString()),this}}function B(...e){return new z(...e)}class H extends p{constructor(...e){super("input",...e)}name(e){return this.element.setAttribute("name",e),this}type(e){return this.element.setAttribute("type",e),this}value(e){return this.element.setAttribute("value",e),this}onFocus(e){return this.element.addEventListener("focus",e),this}onChange(e){return this.element.addEventListener("change",e),this}required(){return this.element.setAttribute("required","required"),this}pattern(e){this.element.setAttribute("pattern",e)}}function G(n){var a;(a=n)&&a.length>=2&&new RegExp(/^([a-zа-яё]){2,}(?=(,\s|\s|-)*(?=[a-zа-яё]*)){0,3}|\d{2,6}$/gi).test(a)?async function(n){const a=await function(t){const{language:n}=e;return i.searchParams.set("q",t),i.searchParams.set("language",n),i.searchParams.set("pretty","1"),i.searchParams.set("key","81015d7e7219436abb15a79cd774330f"),r(i).then((e=>{const{results:t}=e||{};for(const e of t){const{components:t}=e,{city:n,town:r,village:a,neighbourhood:i,suburb:s,highway:o}=t;if(void 0!==n||void 0!==r||void 0!==i||void 0!==a||void 0!==s||void 0!==o)return e}const[n]=t||[];return n}))}(n);if(void 0===a)return;const{geometry:s,components:o}=a,{lat:c,lng:u}=s,{country:l,state:h,city:m,town:g,village:p,neighbourhood:y,suburb:_,place:w,highway:f}=o,b=d(u,c);e.city=m||g||_||p||w||y||f||h||"",e.country=l||h||"",e.latitude=c.toString(),e.longitude=u.toString(),e.locationMapLink=b,t("state",e)}(n).then(h).then(Q):alert(`${U("Enter the name of the City or City and Country")}`)}const N=()=>b("header").content(w("wrapper").content(w("header__wrapper").content(w("header__nav").content(w("header__list").content(B("header__item-radio").type("button").ariaChecked(!0).role("checkbox").onClick((()=>{m().then(Q)})).content(E("fas","fa-images"))),(()=>{const{language:t}=e;return W("header__list").content(B("header__item-radio","lang","left").id("en").type("button").ariaChecked("en"===t).role("checkbox").onClick((()=>X("en"))).content("EN"),B("header__item-radio","lang","right").id("ru").type("button").ariaChecked("ru"===t).role("checkbox").onClick((()=>X("ru"))).content("RU"))})(),(()=>{const{units:t}=e;return W("header__list").content(B("header__item-radio","unit","left").id("metric").type("button").ariaChecked("metric"===t).role("checkbox").onClick((()=>ee("metric"))).content(" °C"),B("header__item-radio","unit","right").id("imperial").type("button").ariaChecked("imperial"===t).role("checkbox").onClick((()=>ee("imperial"))).content(" °F"))})()),(()=>{let e;return W("header__list").onSubmit((t=>{G(e),t.preventDefault()})).content(new H(...["header__search-input"]).id("search-input").type("text").value(`${U("Search City")}`).onFocus((e=>{e.target.value=""})).onChange((t=>{e=t.target.value})).required(),B("header__btn").id("btn-search").type("submit").content(`${U("Search")}`))})())));class Y extends p{constructor(...e){super("body",...e)}set(e){return this.element.style.backgroundImage=`url('${e}')`,this}}let J;class V{constructor(e){const{bgLink:t,timeZone:n,language:r}=e;this.bgLink=t,this.timeZone=n,this.language=r}refreshDate(){const e=document.querySelector("#forecast__date");null!==e&&(e.innerHTML=u(this.timeZone,this.language))}render(){const t=document.querySelector("body"),{element:n}=new Y(...[]).set(this.bgLink).content(N(),(()=>{const{country:t,city:n,latitude:r,longitude:a,weatherState:i,weatherFeelsLike:s,temperature:o,wind:c,humidity:d,dailyTemp:h,dailyWeatherState:m,dailyWeatherIcon:g,locationMapLink:p,timeZone:_,language:f,weekDays:L}=e;return new y(...["forecast"]).content(w("wrapper").content(b("forecast__header").content(new k(...["forecast__title"]).id("city").content(n,t?`, ${t}`:""),S("forecast__date").id("forecast__date").content(u(_,f))),w("forecast__wrapper").content(x("forecast__weather").content(w("forecast_realtime__wrapper").content(w("forecast_realtime").id("currentWeather").content(o,F("current_weather__icon").src(i.icon)),w("forecast_details").content(new $(...["forecast_details__title"]).content(i.description),new A(...["forecast_details__list"]).content(T().content(`${U("Feels like")} ${s}°`),T().content(`${U("Wind")} ${c.speed} `,new j(...["small"]).content(` ${U("m/s")} `),E("fas","fa-location-arrow","small"),` ${c.deg}° `),T().content(`${U("Humidity")} ${d}%`)))),w("forecast__list").content(w("forecast__list__item").content(Z("forecast_weekday__title").content(L.dayFirst),Z("small").content(m.dayFirst),w("forecast__item__wrapper").content(w("forecast__item").content(h.dayFirst),w("forecast__img").content(F("forecast__img").src(g.dayFirst)))),w("forecast__list__item").content(Z("forecast_weekday__title").content(L.daySecond),Z("small").content(m.daySecond),w("forecast__item__wrapper").content(w("forecast__item").content(h.daySecond),w("forecast__img").content(F("forecast__img").src(g.daySecond)))),w("forecast__list__item").content(Z("forecast_weekday__title").content(L.dayThird),Z("small").content(m.dayThird),w("forecast__item__wrapper").content(w("forecast__item").content(h.dayThird),w("forecast__img").content(F("forecast__img").src(g.dayThird)))))),x("location").content(new R(...["location__map"]).id("location-map").content(new I(...["location__iframe"]).src(p).id("location-iframe")),w("location__coordinates").content(S().id("latitude").content(`${U("Latitude")}: ${l(r)}`),S().id("longitude").content(`${U("Longitude")}: ${l(a)}`))))))})());document.querySelector("html").replaceChild(n,t),void 0!==J&&clearInterval(J),J=setInterval(this.refreshDate.bind(this),1e3)}}function Q(){new V(e).render()}function K(n,r){e[n]=r,t("state",e)}function X(e){K("language",e),g().then(h).then(Q)}function ee(e){K("units",e),h().then(Q)}(async function(){(function(){const t=JSON.parse(window.localStorage.getItem("state"));null!==t&&Object.assign(e,t)})(),await async function(){const{ip:n,latitude:i,longitude:s,timezone:o,region:c,postal:u}=await(a.searchParams.set("token","391b1a1e5693e3"),r(a).then((e=>{const[t,n]=e.loc.split(",");return e.latitude=t,e.longitude=n,e}))),l=d(s,i);Object.assign(e,{ip:n,latitude:i,longitude:s,timeZone:o,region:c,postal:u,locationMapLink:l}),t("state",e)}(),Q()})().then((async function(){await g(),await h(),await m(),Q()}))})()})();